*** /dev/null
--- /dev/null
***************
*** 1,3
- const Cc = Components.classes;
- const Ci = Components.interfaces;
- const Cu = Components.utils;v
--- 1 -----
+ // Cc, Ci, Cu should be already defined by tree-copy.js
***************
*** 392,400
-     const ul = this.urlList;
-     const selectedItems = ul.selectedItems;
-     var visIdx = ul.getIndexOfFirstVisibleRow();
-     var lastIdx = visIdx + ul.getNumberOfVisibleRows();
-   
-     
-     
-     
-     
--- 397,402 -----
+     const ul = this.urlListDisplay;
+     const selectedItems = noscriptTreeCc.getSelectedItems(ul, this.whitelistURLs);
+     var visIdx = ul.boxObject.getFirstVisibleRow();
+     var lastIdx = visIdx + ul.boxObject.getPageLength();
+ 
+ 
***************
*** 412,419
-       
-       
-     if(selectedItems.length == 1) {
-       if(removed.length == 1) {
-         ul.removeItemAt(ul.getIndexOfItem(selectedItems[0])); 
-       }
-       return;
-     }
--- 0 -----
***************
*** 422,429
-     try {
-       var rowCount = ul.getRowCount();
-       if(rowCount > lastIdx) {
-         ul.scrollToIndex(visIdx);
-       } else {
-         ul.ensureIndexIsVisible(rowCount - 1);
-       }
-     } catch(e) {}
--- 0 -----
